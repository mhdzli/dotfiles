#!/bin/bash
case "$1" in
    start)
        swaymsg -t get_tree | jq -r '.nodes[].nodes[].nodes[], .nodes[].nodes[].floating_nodes[] | (.id)' > /tmp/switch_windows
        #focused=$(swaymsg -t get_tree | jq -r '.. | (.nodes? // empty)[] | select(.'focused' and .pid) | (.id)')
        ;;
    next)
        swaymsg \[con_id=$(cat /tmp/switch_windows | head -n 1)] focus
        sed -i '1{1h;1!H;d};$G' /tmp/switch_windows
        #sed -e '1{H;d;}' -e '${p;x;s/^\n//;}' /tmp/switch_windows
        #sed '1{H;d}; ${p;x;s/^\n//}' /tmp/switch_windows
    ;;
    prev) 
        sed -i '1h;1d;$!H;$!d;G' /tmp/switch_windows
        swaymsg \[con_id=$(cat /tmp/switch_windows | tail -n 1)] focus
    ;;
esac

