#!/bin/sh

# A menu wrapper script for system functions.

menu="$MENU"

# For non-systemd init systems.
case "$(readlink -f /sbin/init)" in
    *runit*) hib="sudo -A zzz" ;;
    *openrc*) reb="sudo -A openrc-shutdown -r"; shut="sudo -A openrc-shutdown -p" ;;
esac

pgrep swayidle > /dev/null && active_idle=" swayidle" || active_idle=" swayidle"

cmds="\
 lock,            swaylock -eFfki ~/Pictures/lockscreen.png
 leave sway,      swaymsg exit
 renew sway,      swaymsg reload
 leave hyprland,  hyprctl dispatch exit
⏾ hibernate,       ${hib:-systemctl suspend-then-hibernate -i}
 reboot,          ${reb:-sudo -A reboot}
⏻ shutdown,        ${shut:-sudo -A shutdown -h now}
${active_idle},    toggle_swayidle"

choice="$(echo "$cmds" | cut -d',' -f 1 | $menu)" || exit 1

eval "$(echo "$cmds" | grep "^$choice," | cut -d ',' -f2-)"
